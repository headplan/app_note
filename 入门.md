# 入门

### **App后台的功能**

**最重要的两个应用场景:**

* 远程存储数据:音乐列表数据

* 消息中转:用户a向用户b发消息,这条消息需要经过App后台中转,才能达到用户b.


**App后台架构:**

架构设计初期要问自己的三个问题:有什么业务?遇到什么问题?有什么可行的技术解决方案?

然后就可以快速的整理初步的架构:

* 梳理App业务流程
* 整理业务流程可能遇到的问题
* 探讨技术解决方案

**架构设计特点:**

* 架构和业务紧密相关;

  * 每个App都有独自的业务逻辑,遇到的问题和解决方案也不一样,因此机构也不尽相同.

* 架构的演变由业务驱动;

  * 例如,App初期查询用户数据每次都查询数据库,但经过用户量增大,数据库查询压力增大,就可能考虑缓存或查询迁移到NoSQL
  * 初期架构不合理,后期也会带来麻烦,但架构周期过长,又会影响进度.其间取舍,按实际情况出发.


架构是为了满足业务的需求而设计的,切忌不宜设计过度.

### **App和App后台的通信**

几个疑问:

**用HTTP协议还是私有协议?**

使用私有协议相当于使用暗语通信,其类似开发一套新的语言,成本较高,通常还是选择HTTP协议.

**通信使用长连接还是短连接?**

App和服务器通信使用长连接还是短连接,可以理解为手机一直保持着通话,还是需要时才拨号通话.

* 长连接
  * 当App和服务器通信使用长连接,服务器能保持的通信数量有限,达到限制就必须增加服务器才能继续和后台通信.这种通信方式多数使用Socket或WebSocket连接长时间连接,通常在手游和聊天推送服务中使用.


* 短连接
  * 这种通信方式主要是HTTP协议,是现在主流的通信方式,开发效率高并且有大量的第三方工具可以使用.推荐使用.


**App和后端是怎么通信的?**

App后台只提供了一系列的功能给App使用,这系列的功能以API的形式提供.

API的定义:应用程序编程接口,是一些预先定义的函数.目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力,而又无须访问源码,或理解内部工作机制的细节.

当App调用后端提供API的时候,只需要明确三点:

1. API的用途
2. 输入什么
3. 结果是什么

至于API内部是怎么处理的,App无须知道.

**后端是返回给API的数据格式**

API一般是以HTTP的形式调用的,通过HTTP传入参数返回数据.常见的返回JSON数据格式或XML数据格式.

* JSON是一种轻量级的数据交换格式,采用完全独立于语言的文本格式,易于编写和阅读,也易于机器解析和生成.

* XML采用标记数据定义数据类型,允许用户对自己的标记语言进行定义的源语言.它非常适合网络传输,提供统一的方法来描述和交换独立于应用程序或供应商的结构化数据.


但是,表示相同的数据内容,XML花费更多的字节.所以现在大都数API都是以JSON作为返回数据的格式.



